<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Circos</title>
        <script src="d3.js"></script>
        <script src="d_h_data.js"></script>
        <script src="//d3js.org/d3.v3.min.js"></script>

        <script src="https://d3js.org/d3-array.v1.min.js"></script>
        <script src="https://d3js.org/d3-path.v1.min.js"></script>
        <script src="https://d3js.org/d3-chord.v1.min.js"></script>
    </head>
    <body>
        <script>
            var width = 1000, height = 1000;
            var ir = 350, or = 400;

            var data_1 = danRer10_data;
            var data_2 = hg38_data;
            var data = data_1.concat(data_2);

            var sum = 0;
            var temp = [];

            for ( var i = 0; i < data.length; i++ ){
                sum += data[i];
                temp.push(sum);
            }

            var group = d3.select("body").append("svg")
                            .attr("width", width)
                            .attr("height", height)
                            .append("g")
                                .attr("transform", "translate(" + width/2 + "," + height/2 + ")");

            var arc = d3.svg.arc()
                        .innerRadius(ir)
                        .outerRadius(or)
                        .cornerRadius(5);
                        

            var pie = d3.layout.pie()
                        .sort(null)
                        .value(function(d){ return d; })
                    //    .padAngle(.005);

            var arcs = group.selectAll(".arc")
                            .data(pie(data))
                            .enter()
                                .append("g")
                                .attr("class", "arc");

           
            var ribbon = d3.ribbon()
                     .radius(240);

            ribbon({
                source: {startAngle: 0, endAngle: 10},
                target: {startAngle: 90, endAngle: 130}
            });

            

            arcs.append("path")
                .attr("d", arc)
                .attr("fill", function(d,i){

                    var p = 5000000;
                    var angle = -90 + 360*((p-d.data/2 + temp[i])/sum);
                    var move = or + 25;
                    if ( angle < -90 || angle > 90 ){
                        angle += (180 - 720 * (p/sum));
                        move *= -1;
                    }
                    var index = i;
                    if ( i >= 25 )
                        index -= 25;

                    arcs.append("text").attr("text-anchor", "middle").text("chr" + (index + 1) )
                        .attr("transform", "rotate(" + angle + ")" + "translate(" + move  + ",0)")
                        .style("stroke", function (){
                            if( i >= 25 )
                                return "steelblue";
                            else
                                return "orange";
                        });

                    if( i >= 25 )
                        return "steelblue";
                    else
                        return "orange";
                })
                .style("stroke", "black")
                .style("stroke-width", 1)
                .on("mouseover", function(d,i){
                    d3.select(this).attr("fill", "red");

                })
                .on("mouseout", function(d,i){
                    d3.select(this).attr("fill", function(){
                        if( i >= 25 )
                            return "steelblue";
                        else
                            return "orange";
                    });

                })
                
                

        </script>
    </body>
</html>